In this project, we try to analyse the impact of sampling bias in phylogenetics. The two samples we used are West Nile Virus (WNV) and Yellow Fever Virus (YFV). The dataset we used are provided in the BEAST tutorials 
https://beast.community/workshop_continuous_diffusion_wnv and https://beast.community/workshop_continuous_diffusion_yfv

1.Methods and inputs
To show that the sampling bias exists, we separate both datasets into two parts based on their locations and then simulate on the whole dataset and the subsamples. After getting the trees, we compare the roots from the whole dataset and the subsamples. If they are significantly different, we can conclude that sampling bias exists.
All the input files are in the folders /WNV and /YFV, the dataset in the folder are as shown in the name of the folder.
The WNV dataset is separated into 52 in the east and 52 in the west based on their longitudes. For example, the file WNV/WNV_east.fasta contains the DNA sequence information of 52 samples in the east. The file WNV/WNV_lat_long_east.txt contains the location information of the 52 samples in the east.
To push the result further, we randomly sample 20 from the east and add them to the west. Then we will do simulations on this and show if the root changes. The files are WNV_west+20east.fasta and WNV_lat_long_west+20east.txt. We do the same on the counterpart 'east+20west' files.
The YFV dataset is separated into 35 in the north (latitude larger than -19) and 30 in the south (latitude less than -19). The file YFV/YFV_sequences_north.fasta contains the DNA sequence information of 35 samples in the north. The file YFV/YFV_coordinates_north.txt contains the location information of the 35 samples in the north.
As before, we randomly sample 10 from the south and add them to the north. Then we will do simulations on this and show if the root changes. The files are YFV_sequences_north+10south.fasta and YFV_coordinates_north+10south.txt. We do the same on the counterpart 'south+10north' files.
The Python scripts of separating them are WNV_separate.py and YSV_separate.py.

2.Disc Simulation
To simulate the disc-based extinction/recolonisation continuum model, we use the discsim package in Python. To use discsim, we derive the diffusion rate of the disc model. The Latex file of this derivation is provided as diffusion_rate. 
The file disc_sim.py is the simulation script. Note that the output tree of discsim is in oriented tree format. We need to transfer it into Newick format which we can use in BEAST. The trasformation file is provided at https://github.com/tyjo/newick.py. In order that disc_sim.py could run, we provide the newick.py file downloaded from the original webpage.

3.XML files and outputs
The XML files are provided in the folder /XML_files. Note that we set a different number of MCMC steps for different files to make the efficient sample size larger than 200 for every parameter. All the XML files are generated by following the BEAST tutorials (https://beast.community/workshop_continuous_diffusion_wnv and https://beast.community/workshop_continuous_diffusion_yfv) except the MCMC steps.
The output files of running XML files in BEAST are provided in https://1drv.ms/u/s!As2KByhNwNMuaXaOTLuwaeu6DJ0?e=9rjt8Z. The compressed outputs for Linux/Mac could be downloaded at https://1drv.ms/u/s!As2KByhNwNMuf4eZB-nN4KzywBU?e=a2TMY6. Note that there are two output results for YFV_cauchy_RRW_north, they are named YFV_cauchy_RRW_north.* and YFV_cauchy_RRW_north2.*. The Python script of combining them is YFV_north_combine.py. The combined trees file is YFV_cauchy_RRW_north_combined.trees.


